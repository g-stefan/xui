/**
* jquery-autocompleter v0.7.0 - 2022-10-08
* Easy customisable and with localStorage cache support.
* https://github.com/fitiskin/jquery-autocompleter#readme
* @license (c) 2022 Artem Fitiskin <artemfitiskin@gmail.com> (https://github.com/fitiskin) MIT Licensed
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).$)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var l=0,n=[9,13,17,19,20,27,33,34,35,36,37,39,44,92,113,114,115,118,119,120,122,123,144,145],r=["source","empty","limit","cache","cacheExpires","focusOpen","enterSelect","selectFirst","changeWhenSelect","highlightMatches","ignoredKeyCode","customLabel","customValue","onBeforeSend","onBeforeShow","onEmpty","onItem","onListOpen","onListClose","onBeforeLaunch","template","offset","format","combine","callback","minLength","delay"],u=window.navigator.userAgent||window.navigator.vendor||window.opera,c=/Firefox/i.test(u),i=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(u),s=c&&i,p=null,d=null,m="autocompleterCache",f=function(){var e=void 0!==window.localStorage;if(e)try{localStorage.setItem("autocompleter","autocompleter"),localStorage.removeItem("autocompleter")}catch(t){e=!1}return e}(),h={source:null,asLocal:!1,empty:!0,limit:10,minLength:0,delay:0,customClass:[],cache:!0,cacheExpires:86400,focusOpen:!0,enterSelect:!0,hint:!1,selectFirst:!1,changeWhenSelect:!0,highlightMatches:!1,ignoredKeyCode:[],customLabel:!1,customValue:!1,onBeforeSend:o.default.noop,onBeforeShow:o.default.noop,onEmpty:o.default.noop,onItem:o.default.noop,onListOpen:o.default.noop,onListClose:o.default.noop,onBeforeLaunch:o.default.noop,template:!1,offset:!1,format:null,combine:null,callback:o.default.noop},y={defaults:function(e){return h=o.default.extend(h,e||{}),"object"!==a(this)||o.default(this)},option:function(e){return o.default(this).each((function(t,a){var l=o.default(a).next(".autocompleter").data("autocompleter");for(var n in e)-1!==o.default.inArray(n,r)&&(l[n]=e[n])}))},open:function(){return o.default(this).each((function(e,t){var a=o.default(t).next(".autocompleter").data("autocompleter");a&&E(null,a)}))},close:function(){return o.default(this).each((function(e,t){var a=o.default(t).next(".autocompleter").data("autocompleter");a&&T(null,a)}))},clearCache:function(){D()},destroy:function(){return o.default(this).each((function(e,t){var a=o.default(t).next(".autocompleter").data("autocompleter");a&&(a.jqxhr&&a.jqxhr.abort(),a.$autocompleter.hasClass("open")&&a.$autocompleter.find(".autocompleter-selected").trigger("click.autocompleter"),a.originalAutocomplete?a.$node.attr("autocomplete",a.originalAutocomplete):a.$node.removeAttr("autocomplete"),a.$node.off(".autocompleter").removeClass("autocompleter-node"),a.$autocompleter.off(".autocompleter").remove())}))}};function v(e){e=o.default.extend({},h,e||{}),null===p&&(p=o.default("body"));for(var t=o.default(this),a=0,l=t.length;a<l;a++)g(t.eq(a),e);return t}function g(e,t){if(!e.hasClass("autocompleter-node")){"string"!=typeof(t=o.default.extend({},t,e.data("autocompleter-options"))).source||".json"!==t.source.slice(-5)&&!0!==t.asLocal||o.default.ajax({url:t.source,type:"GET",dataType:"json",async:!1}).done((function(e){t.source=e}));var a='<div class="autocompleter '+t.customClass.join(" ")+'" id="autocompleter-'+(l+1)+'">';t.hint&&(a+='<div class="autocompleter-hint"></div>'),a+='<ul class="autocompleter-list"></ul>',a+="</div>",e.addClass("autocompleter-node").after(a);var n=e.next(".autocompleter").eq(0),r=e.attr("autocomplete");e.attr("autocomplete","off");var u=o.default.extend({$node:e,$autocompleter:n,$selected:null,$list:null,index:-1,hintText:!1,source:!1,jqxhr:!1,response:null,focused:!1,query:"",originalAutocomplete:r,guid:l++},t);u.$autocompleter.on("mousedown.autocompleter",".autocompleter-item",u,A).on("mousedown.autocompleter",".autocompleter-list",u,(function(){return!1})).data("autocompleter",u),u.$node.on("keyup.autocompleter",u,C).on("keydown.autocompleter",u,S).on("focus.autocompleter",u,q).on("blur.autocompleter",u,j).on("mousedown.autocompleter",u,L)}}function $(e){clearTimeout(d),e.onBeforeLaunch(e.$autocompleter,e.$node),e.query=o.default.trim(e.$node.val()),!e.empty&&0===e.query.length||e.minLength&&e.query.length<e.minLength?w(e):e.delay?d=setTimeout((function(){b(e)}),e.delay):b(e)}function b(e){if("object"===a(e.source)){w(e);var t=function(e,t,o){var a=[];if(e=e.toUpperCase(),t.length)for(var l=0;l<2;l++)for(var n in t)if(a.length<o.limit){var r=o.customLabel&&t[n][o.customLabel]?t[n][o.customLabel]:t[n].label;switch(l){case 0:0===r.toUpperCase().search(e)&&(a.push(t[n]),delete t[n]);break;case 1:-1!==r.toUpperCase().search(e)&&(a.push(t[n]),delete t[n])}}return a}(e.query,function(e){var t;if(null===e||"object"!==a(e))return e;for(var o in t=e.constructor(),e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}(e.source),e);t.length&&x(t,e)}else{e.jqxhr&&e.jqxhr.abort();var l={limit:e.limit,query:e.query};"function"==typeof e.combine&&(l=e.combine(l)),e.jqxhr=o.default.ajax({url:e.source,dataType:"json",crossDomain:!0,data:l,beforeSend:function(t){if(e.$autocompleter.addClass("autocompleter-ajax"),w(e),e.onBeforeSend(),e.cache){var o=function(e,t){var o,a=!1;if(t=t||!1,!e)return!1;return!(!(o=I[e])||!o.value)&&(a=o.value,!(o.timestamp&&t&&+new Date-o.timestamp>1e3*t)&&a)}(this.url,e.cacheExpires);o&&(t.abort(),x(o,e))}}}).done((function(t){e.offset&&(t=function(e,t){t=t.split(".");for(;e&&t.length;)e=e[t.shift()];return e}(t,e.offset)),"function"==typeof e.format&&(t=e.format(t)||[]),e.cache&&function(e,t){if(!f)return;if(e&&t){I[e]={value:t,timestamp:+new Date};try{localStorage.setItem(m,JSON.stringify(I))}catch(e){if(22!==(e.code||e.number||e.message))throw e;D()}}}(this.url,t),x(t,e)})).always((function(){e.$autocompleter.removeClass("autocompleter-ajax")}))}}function w(e){e.response=null,e.$list=null,e.$selected=null,e.index=0,e.$autocompleter.find(".autocompleter-list").empty(),e.$autocompleter.find(".autocompleter-hint").removeClass("autocompleter-hint-show").empty(),e.hintText=!1,T(null,e)}function x(e,t){!function(e,t){for(var a="",l=0,n=e.length;l<n;l++){var r=["autocompleter-item"],u=new RegExp(t.query,"gi");t.selectFirst&&0===l&&!t.changeWhenSelect&&r.push("autocompleter-item-selected");var c=t.customLabel&&e[l][t.customLabel]?e[l][t.customLabel]:e[l].label,i=c;c=t.highlightMatches?c.replace(u,"<strong>$&</strong>"):c;var s=t.customValue&&e[l][t.customValue]?e[l][t.customValue]:e[l].value;if(t.template){var p=t.template.replace(/({{ label }})/gi,c);for(var d in e[l])if(Object.prototype.hasOwnProperty.call(e[l],d)){var m=new RegExp("{{ "+d+" }}","gi");p=p.replace(m,e[l][d])}c=p}a+=s?'<li data-value="'+s+'" data-label="'+i+'" class="'+r.join(" ")+'">'+c+"</li>":'<li data-label="'+i+'" class="'+r.join(" ")+'">'+c+"</li>"}if(e.length&&t.hint){var f=t.customLabel&&e[0][t.customLabel]?e[0][t.customLabel]:e[0].label,h=f.substr(0,t.query.length).toUpperCase()===t.query.toUpperCase()&&f;if(h&&t.query!==f){var y=new RegExp(t.query,"i"),v=h.replace(y,"<span>"+t.query+"</span>");t.$autocompleter.find(".autocompleter-hint").addClass("autocompleter-hint-show").html(v),t.hintText=v}}t.response=e,t.$autocompleter.find(".autocompleter-list").html(a),t.$selected=t.$autocompleter.find(".autocompleter-item-selected").length?t.$autocompleter.find(".autocompleter-item-selected"):null,t.$list=e.length?t.$autocompleter.find(".autocompleter-item"):null,t.index=t.$selected?t.$list.index(t.$selected):-1,t.$autocompleter.find(".autocompleter-item").each((function(e,a){o.default(a).data(t.response[e]),t.onItem(t.$autocompleter,o.default(a),e,t.response[e])})),e.length||t.onEmpty();t.onBeforeShow()}(e,t),t.$autocompleter.hasClass("autocompleter-focus")&&E(null,t)}function C(e){var t=e.data,a=e.keyCode?e.keyCode:e.which;if(40!==a&&38!==a||!t.$autocompleter.hasClass("autocompleter-show"))-1===o.default.inArray(a,n)&&-1===o.default.inArray(a,t.ignoredKeyCode)&&$(t);else{var l,r,u=t.$list.length;u&&(u>1?t.index===u-1?(l=t.changeWhenSelect?-1:0,r=t.index-1):0===t.index?(l=t.index+1,r=t.changeWhenSelect?-1:u-1):-1===t.index?(l=0,r=u-1):(l=t.index+1,r=t.index-1):-1===t.index?(l=0,r=0):(r=-1,l=-1),t.index=40===a?l:r,t.$list.removeClass("autocompleter-item-selected"),-1!==t.index&&t.$list.eq(t.index).addClass("autocompleter-item-selected"),t.$selected=t.$autocompleter.find(".autocompleter-item-selected").length?t.$autocompleter.find(".autocompleter-item-selected"):null,t.changeWhenSelect&&O(t))}}function S(e){var t=e.data,o=e.keyCode?e.keyCode:e.which;if(40===o||38===o)e.preventDefault(),e.stopPropagation();else if(39===o){if(t.hint&&t.hintText&&t.$autocompleter.find(".autocompleter-hint").hasClass("autocompleter-hint-show")){e.preventDefault(),e.stopPropagation();var a=!!t.$autocompleter.find(".autocompleter-item").length&&t.$autocompleter.find(".autocompleter-item").eq(0).attr("data-label");a&&(t.query=a,function(e){O(e),B(e),$(e)}(t))}}else 13===o&&(t.enterSelect?t.$autocompleter.hasClass("autocompleter-show")&&t.$selected&&A(e):(e.preventDefault(),e.stopPropagation()))}function q(e,t){if(!t){var o=e.data;o.$autocompleter.addClass("autocompleter-focus"),o.$node.prop("disabled")||o.$autocompleter.hasClass("autocompleter-show")||o.focusOpen&&($(o),o.focused=!0,setTimeout((function(){o.focused=!1}),500))}}function j(e,t){e.preventDefault(),e.stopPropagation();var o=e.data;t||(o.$autocompleter.removeClass("autocompleter-focus"),T(e))}function L(e){if("mousedown"!==e.type||-1===o.default.inArray(e.which,[2,3])){var t=e.data;if(t.$list&&!t.focused&&!t.$node.is(":disabled"))if(i&&!s){var a=t.$select[0];if(window.document.createEvent){var l=window.document.createEvent("MouseEvents");l.initMouseEvent("mousedown",!1,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(l)}else a.fireEvent&&a.fireEvent("onmousedown")}else t.$autocompleter.hasClass("autocompleter-closed")?E(e):t.$autocompleter.hasClass("autocompleter-show")&&T(e)}}function E(e,t){var o=e?e.data:t;o.onListOpen(o.$autocompleter,o.response),!o.$node.prop("disabled")&&!o.$autocompleter.hasClass("autocompleter-show")&&o.$list&&o.$list.length&&(o.$autocompleter.removeClass("autocompleter-closed").addClass("autocompleter-show"),p.on("click.autocompleter-"+o.guid,o,k))}function k(e){if(o.default(e.target).hasClass("autocompleter-node")||o.default(e.target).parents(".autocompleter").length)return!1;T(e)}function T(e,t){var o=e?e.data:t;o.onListClose(),o.$autocompleter.hasClass("autocompleter-show")&&(o.$autocompleter.removeClass("autocompleter-show").addClass("autocompleter-closed"),p.off(".autocompleter-"+o.guid))}function A(e){if("mousedown"!==e.type||-1===o.default.inArray(e.which,[2,3])){var t=e.data;e.preventDefault(),e.stopPropagation(),"mousedown"===e.type&&o.default(this).length&&(t.$selected=o.default(this),t.index=o.default(this).index()),t.$node.prop("disabled")||(T(e),function(e){O(e),B(e),w(e)}(t),"click"===e.type&&t.$node.trigger("focus",[!0]))}}function O(e){e.$selected?(e.hintText&&e.$autocompleter.find(".autocompleter-hint").hasClass("autocompleter-hint-show")&&e.$autocompleter.find(".autocompleter-hint").removeClass("autocompleter-hint-show"),e.$node.val(e.$selected.attr("data-value")?e.$selected.attr("data-value"):e.$selected.attr("data-label"))):(e.hintText&&!e.$autocompleter.find(".autocompleter-hint").hasClass("autocompleter-hint-show")&&e.$autocompleter.find(".autocompleter-hint").addClass("autocompleter-hint-show"),e.$node.val(e.query))}function B(e){e.callback.call(e.$autocompleter,e.$node.val(),e.index,e.response[e.index]),e.$node.trigger("change")}function P(){if(f)return JSON.parse(localStorage.getItem(m)||"{}")}function D(){try{localStorage.removeItem(m),I=P()}catch(e){}}var I=P();o.default.fn.autocompleter=function(e){return y[e]?y[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==a(e)&&e?this:v.apply(this,arguments)},o.default.autocompleter=function(e){"defaults"===e?y.defaults.apply(this,Array.prototype.slice.call(arguments,1)):"clearCache"===e&&y.clearCache.apply(this,null)}}));
//# sourceMappingURL=jquery.autocompleter.min.js.map
